(function(e){function t(t){for(var a,o,s=t[0],c=t[1],l=t[2],u=0,f=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);d&&d(t);while(f.length)f.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(a=!1)}a&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},i={app:0},r=[];function o(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-0b65ffb6":"f67fdb85","chunk-2d0a3196":"525c060a","chunk-2d0a3577":"08e57b7c","chunk-2d0a40c8":"f1e3a7bf","chunk-2d0a43df":"29246f68","chunk-2d0aa90c":"7dcadb75","chunk-2d0aab07":"b4bc5fcb","chunk-2d0abc00":"d579495e","chunk-2d0ae937":"972e1caf","chunk-2d0aeb45":"a7da3444","chunk-2d0af08c":"13b9cb9b","chunk-2d0afa49":"0d8775c1","chunk-2d0b2762":"040008b6","chunk-2d0b6187":"98b8f6c5","chunk-2d0b9262":"1a722d96","chunk-2d0ba136":"1c2c79ef","chunk-2d0bb267":"e21a8941","chunk-2d0bcec1":"04eac3a4","chunk-2d0bdf38":"484e3585","chunk-2d0bff92":"aeb10dc4","chunk-2d0c0494":"fc8dc4d1","chunk-2d0c0a09":"ccdaf638","chunk-2d0c4313":"e8a59f53","chunk-2d0c46d1":"26a18d3e","chunk-2d0c4a95":"8524702c","chunk-2d0c512b":"6432da8e","chunk-2d0c86e3":"3ad7a61f","chunk-2d0c8f4c":"e8ca8a7d","chunk-2d0ceaf4":"fb6a929a","chunk-2d0cf16e":"a58b5444","chunk-2d0d056d":"b352fd49","chunk-2d0d0645":"294ff97f","chunk-2d0d2f22":"002f49f5","chunk-2d0d61fd":"5f2f813d","chunk-2d0d7e63":"3693fe03","chunk-2d0dda4e":"0781d70a","chunk-2d0de971":"0f33a456","chunk-2d0e1b57":"ac0499f6","chunk-2d0e1fbe":"165f4253","chunk-2d0e22d6":"b9b3c7cb","chunk-2d0e4fe5":"5562afa2","chunk-2d0e542a":"444e1c4d","chunk-2d0e57ec":"b32f338b","chunk-2d0e6553":"59054791","chunk-2d0e6c86":"e4bfd896","chunk-2d0ea098":"ac843613","chunk-2d0f0a11":"81a52aab","chunk-2d208ac5":"6742d98f","chunk-2d209408":"344ac544","chunk-2d20f745":"ad4a1523","chunk-2d20ff23":"cb2eb94f","chunk-2d2138c7":"ef6bd49e","chunk-2d216f3b":"eeb0926e","chunk-2d217e5b":"b529a5b7","chunk-2d21b84a":"a58793d6","chunk-2d21dcd2":"36d54505","chunk-2d21f327":"0b267cb0","chunk-2d2214b3":"147874bc","chunk-2d221799":"ca7947fb","chunk-2d221814":"9c3abd2b","chunk-2d221a34":"1eda6924","chunk-2d22502a":"11dd15f9","chunk-2d226775":"c0469318","chunk-2d229411":"85262941","chunk-2d2295e9":"c6cb51d6","chunk-2d22c171":"fb2a7e19","chunk-2d22c2b8":"8b8784b2","chunk-2d22ca58":"7ca668b9","chunk-2d2311f7":"b12123d9","chunk-2d237ee7":"12ce153c","chunk-2d238465":"9c277db1","chunk-30597b4a":"a438a431","chunk-7532b3ea":"0c75ed04","chunk-e13e4362":"38cf6ebf"}[e]+".js"}function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,a){n=i[e]=[t,a]}));t.push(n[2]=a);var r,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=o(e);var l=new Error;r=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=i[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",l.name="ChunkLoadError",l.type=a,l.request=r,n[1](l)}i[e]=void 0}};var u=setTimeout((function(){r({type:"timeout",target:c})}),12e4);c.onerror=c.onload=r,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/warbler/0.1/",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"012a":function(e,t,n){"use strict";n("5407")},"034f":function(e,t,n){"use strict";n("85ec")},"054c":function(e,t,n){},"0f4e":function(e,t,n){},"120c":function(e,t,n){"use strict";n("054c")},2351:function(e,t,n){"use strict";n("62fc")},2808:function(e,t,n){"use strict";n("8521")},"2eef":function(e,t,n){},5407:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.$store.state.fileLoaded?n("router-view"):e._e()],1)},r=[],o={name:"App",components:{},mounted:function(){var e=this.$route.query.d;e?this.$store.dispatch("loadFromQueryString",e):this.$store.dispatch("loadFileFromBrowser")}},s=o,c=(n("034f"),n("2877")),l=Object(c["a"])(s,i,r,!1,null,null,null),u=l.exports,d=n("1da1"),f=(n("96cf"),n("b0c0"),n("e9c4"),n("99af"),n("2f62")),h=n("a002"),m=n.n(h),p=n("b047c"),v=n.n(p),b=n("a80f"),g=n("b138");a["a"].use(f["a"]);var w="CodeWarbler/warbler",y="activeFile",k="warbler",x=[".codewarbler"],_="CodeWarbler files",E='// Libraries available: Tone.js 14.7.77, Tonal.js 4.6.5, Lodash 4.17.21\nconst title = "Untitled file";\n\n// Create a Tone.js oscillator\nvar t = new Tone.Oscillator(400);\nt.volume.value = -12;\nt.start();\nt.toDestination();',C=1e3,O=v()((function(e){window.history.replaceState({},null,e)}),C),S=new f["a"].Store({state:{forage:null,fileLoaded:!1,queryFile:{},isQueryFile:!1,browserFile:{},fileHandle:null,data:{},editorReference:null,alertId:0,alertHeading:"",alertDescription:"",isRunning:!1},mutations:{setEditorReference:function(e,t){e.editorReference=t},setAlert:function(e,t){"fileSave"==t&&(e.alertHeading="File Saved",e.alertDescription="".concat(e.fileHandle.name," was updated.")),e.alertId=Math.random()},setIsRunning:function(e){e.isRunning=!0},setIsNotRunning:function(e){e.isRunning=!1}},getters:{activeFile:function(e){return e.isQueryFile?e.queryFile:e.data},fileAsJson:function(e){return JSON.stringify(e.data)},fileName:function(e){var t;return null===(t=e.fileHandle)||void 0===t?void 0:t.name}},actions:{openFile:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var n,a,i,r,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.state,g["c"],a={extensions:x,multiple:!1,description:_,id:k,excludeAcceptAllOption:!1},t.next=5,Object(g["a"])(a);case 5:return i=t.sent,n.fileHandle=i.handle,t.next=9,n.fileHandle.getFile();case 9:return r=t.sent,t.next=12,r.text();case 12:o=t.sent,s=JSON.parse(o),n.data=s,n.editorReference.getModel().setValue(s.code);case 16:case"end":return t.stop()}}),t)})))()},saveFileToSystem:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var n,a,i,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.state,a=e.dispatch,i=e.getters,r=e.commit,n.fileHandle){t.next=3;break}return t.abrupt("return",a("saveFileToSystemAsNew"));case 3:return o=new Blob([i.fileAsJson],{}),t.next=6,Object(g["b"])(o,{fileName:n.fileHandle.name,description:_,extensions:x},n.fileHandle);case 6:r("setAlert","fileSave");case 7:case"end":return t.stop()}}),t)})))()},saveFileToSystemAsNew:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var n,a,i,r,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.state,a=e.getters,i=e.commit,r=new Blob([a.fileAsJson],{type:"text/json"}),o=n.data.filename||"Untitled.codewarbler",t.next=5,Object(g["b"])(r,{fileName:o,description:_,extensions:x,id:k},null);case 5:s=t.sent,n.fileHandle=s,i("setAlert","fileSave");case 8:case"end":return t.stop()}}),t)})))()},loadFileFromBrowser:function(e){var t=e.state,n=e.dispatch;return t.forage||(t.forage=m.a.createInstance({name:w})),t.forage.getItem(y).then((function(e){e=e?{id:y,data:e}:{id:y,data:{code:E,title:"Untitled file",datetime:Date.now()}},t.browserFile=e,t.data=e.data,n("updatePageTitle"),t.fileLoaded=!0}))},loadFromQueryString:function(e,t){var n=e.state,a=e.dispatch,i=JSON.parse(Object(b["b"])(t));"data"in i&&(i=i.data),n.queryFile=i,n.isQueryFile=!0,n.fileLoaded=!0,a("updatePageTitle")},saveCurrentToFile:function(e){var t=e.getters,n=e.dispatch,a=t.activeFile;n("saveFile",a),n("saveFileToSystem")},updateCode:function(e,t){var n=e.getters,a=e.dispatch,i=n.activeFile;i.code=t,a("saveFile",i)},updateTitle:function(e,t){var n=e.getters,a=e.dispatch,i=n.activeFile;t!=i.title&&(i.title=t,a("saveFile",i))},saveFile:function(e,t){var n=e.state,a=e.getters,i=e.dispatch;if(t.datetime=Date.now(),t.title||(t.title=t.name),delete t.name,delete t.snippet,t.libraryName="Tone.js",t.libraryVersion=Object({NODE_ENV:"production",VUE_APP_WARBLER_VERSION:"0.1",VUE_APP_TONE_DEFINITIONS_VERSION:"14.7.77",VUE_APP_GIT_REV:"7a1bd4a",VUE_APP_BUILD_DATE:"1647893300299",BASE_URL:"/warbler/0.1/"}).VUE_APP_TONE_VERSION,t.appName="warbler",t.appVersion="0.1",n.fileHandle&&(t.filename=n.fileHandle.name),i("updatePageTitle"),n.data=t,n.isQueryFile){var r=JSON.stringify(a.activeFile),o=Object(b["a"])(r),s="".concat(window.location.pathname,"?d=").concat(o);O(s)}else n.forage.setItem(y,t).then((function(e){})).catch((function(e){}))},gotoPermanentUrl:function(e){var t=e.getters,n=JSON.stringify(t.activeFile),a=Object(b["a"])(n),i="https://codewarbler.github.io/warbler/".concat("0.1","/?d=").concat(a);window.open(i,"_blank")},updatePageTitle:function(e){var t=e.getters;document.title="".concat(t.activeFile.title," - CodeWarbler")}}}),j=n("8c4f"),T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editor-component"},[n("Header",{staticClass:"header",attrs:{id:"header","unapplied-changes":e.hasUnappliedChanges},on:{startFunction:e.emitChange,closeContext:e.closeContext,record:e.record}}),n("div",{staticClass:"visuals",style:e.visualsStyle},[e._l(e.signalObjects,(function(t,a){return n("div",{key:t.name+a,class:{active:e.isLineActive(t)},on:{mouseover:function(n){return e.makeLinesActive(t)},mouseleave:function(n){return e.makeLinesInactive(t)}}},["scope"==t.type?n("Scope",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e(),"spectrum"==t.type?n("Spectrum",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e(),"waveform"==t.type?n("Waveform",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e(),"meter"==t.type?n("Meter",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e(),"button"==t.type?n("Button",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e(),"slider"==t.type?n("Slider",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e()],1)})),e.hasError?n("div",{staticClass:"error"},[n("h1",[e._v(e._s(e.errorName))]),n("p",[e._v("Near line number "+e._s(e.errorLine))]),n("code",[e._v(e._s(e.errorMessage))])]):e._e()],2),n("div",{ref:"editor",staticClass:"editor",style:e.editorStyle}),n("Footer",{staticClass:"footer"}),n("Notification",{staticClass:"notification"})],1)},R=[],F=(n("b64b"),n("d3b7"),n("3ca3"),n("ddb0"),n("caad"),n("2532"),n("ac1f"),n("1276"),n("5319"),n("5b81"),n("c2c6")),A=n("5e54"),N=n("772f"),L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header"},[n("div",{staticClass:"left"},[n("span",{staticClass:"heading-1"},[e._v("Warbler ")]),n("span",[e._v(e._s(e.$store.getters["fileName"]))])]),n("div",{staticClass:"center"},[n("div",[n("button",{class:{active:e.$store.state.isRunning,unapplied:e.unappliedChanges},attrs:{id:"runButton"},on:{click:e.startFunction}},[e._v(" Run ")]),n("button",{attrs:{id:"stopButton"},on:{click:e.closeContext}},[e._v("Stop")]),n("button",{on:{click:function(t){return e.$store.dispatch("openFile")}}},[e._v("Load")]),n("button",{on:{click:function(t){return e.$store.dispatch("saveFileToSystem")}}},[e._v("Export")]),n("button",{on:{click:function(t){return e.$store.dispatch("gotoPermanentUrl")}}},[e._v(" Permanent Link ")]),n("button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{id:"recordButton"},on:{click:function(t){return e.$emit("record")}}},[e._v(" Record ")])])])])},D=[],I={name:"Header",props:{unappliedChanges:{type:Boolean,default:function(){return!1}}},data:function(){return{version:"0.1"}},methods:{startFunction:function(){this.$emit("startFunction")},closeContext:function(){this.$emit("closeContext")}}},H=I,P=(n("2351"),Object(c["a"])(H,L,D,!1,null,"1e693bd0",null)),$=P.exports,V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"footer-container"},[e._m(0),n("div",{staticClass:"right"},[e._m(1),n("span",[n("abbr",{attrs:{title:"Build "+e.VUE_APP_GIT_REV+" from "+e.VUE_APP_BUILD_DATE}},[e._v(" Warbler "+e._s(e.VUE_APP_WARBLER_VERSION)+" ")])])])])},U=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"left"},[n("a",{attrs:{href:"https://codewarbler.github.io/#warbler"}},[e._v("About")]),n("a",{attrs:{href:"https://codewarbler.github.io/warbler/#examples"}},[e._v("Examples")]),n("a",{attrs:{href:"https://github.com/codewarbler/warbler"}},[e._v("Github")]),n("a",{attrs:{href:"https://twitter.com/codewarbler"}},[e._v("Twitter")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"quickkeys"},[n("b",[e._v("Run:")]),e._v(" Cmd + Return "),n("b",[e._v("Stop: ")]),e._v(" Cmd + . ")])}],M={name:"Footer",data:function(){var e=new Date(parseInt("1647893300299",10));return{VUE_APP_WARBLER_VERSION:"0.1",VUE_APP_BUILD_DATE:e.toUTCString(),VUE_APP_GIT_REV:"7a1bd4a"}}},B=M,W=(n("af27"),Object(c["a"])(B,V,U,!1,null,"e08ce656",null)),z=W.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"notification-container"},[n("Transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:e.alerting,expression:"alerting"}],staticClass:"alert-container"},[n("h1",[e._v(e._s(e.$store.state.alertHeading))]),n("p",[e._v(e._s(e.$store.state.alertDescription))])])])],1)},K=[],J={name:"Notification",data:function(){return{alerting:!1}},computed:{alertId:function(){return this.$store.state.alertId}},watch:{alertId:function(){this.triggerAlert()}},mounted:function(){},methods:{triggerAlert:function(){var e=this;this.alerting=!0,setTimeout((function(){e.alerting=!1}),1e3)}}},Y=J,q=(n("012a"),Object(c["a"])(Y,G,K,!1,null,"2be0532f",null)),X=q.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div"},[n("div",{ref:"canvas"})])])},Z=[],ee=(n("a9e3"),n("cb29"),n("b680"),n("3425")),te=n.n(ee),ne={name:"Meter",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{}},mounted:function(){var e=this,t=function(t){var n=e.width,a=e.height;t.setup=function(){t.createCanvas(n,a),t.frameRate(40)},t.draw=function(){if(e.signalObj){t.background(0),t.fill("magenta");var i=n/2,r=e.signalObj.meter.getValue()[0],o=e.signalObj.meter.getValue()[1],s=(n-i)/2-1,c=n/2+1;t.rect(s,a-r*a,i/2,a+20),t.rect(c,a-o*a,i/2,a+20),t.fill("white"),t.textSize(10);var l=2;t.textAlign(t.LEFT),t.text(r.toFixed(l),3,a-4),t.textAlign(t.RIGHT),t.text(o.toFixed(l),n-4,a-4),t.textSize(10),t.textAlign(t.RIGHT),t.text(e.signalObj.name,n-3,11)}}};new te.a(t,this.$refs.canvas)}},ae=ne,ie=(n("120c"),Object(c["a"])(ae,Q,Z,!1,null,"45890268",null)),re=ie.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div"},[n("div",{ref:"canvas"})])])},se=[],ce={name:"Waveform",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{values:[],min:null,max:null}},mounted:function(){var e=this;this.values=new Array(e.width).fill(0);var t=function(t){var n=0,a=e.width,i=e.height;t.setup=function(){t.createCanvas(a,i),t.frameRate(30)},t.draw=function(){if(e.signalObj){var r;t.background(0),t.stroke("#00adad"),r=e.signalObj.renderValue?e.signalObj.renderValue(e.signalObj.signal):e.signalObj.meter.getValue(),(null==e.min||e.min>r)&&(e.min=r),(null==e.max||e.max<r)&&(e.max=r);var o=e.min,s=e.max;e.signalObj.approxValue&&(r=e.signalObj.approxValue);var c=1-(r-o)/(s-o),l=c*i;e.values.shift(),e.values.push(l);for(var u=0;u<e.values.length;u++)t.line(n+u,e.values[u],n+u,i);t.fill("white"),t.textSize(10);var d=2;t.textAlign(t.LEFT),t.text(e.max.toFixed(d),3,11),t.text(e.min.toFixed(d),3,i-4),t.textSize(10),t.textAlign(t.RIGHT),t.text(r.toFixed(d),a-4,i-4),t.textAlign(t.RIGHT),t.text(e.signalObj.name,a-3,11)}}};new te.a(t,this.$refs.canvas)}},le=ce,ue=(n("709a"),Object(c["a"])(le,oe,se,!1,null,"007d9584",null)),de=ue.exports,fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div"},[n("div",{ref:"canvas"})])])},he=[],me=(n("fb6a"),n("d81d"),{name:"Spectrum",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{}},mounted:function(){var e=this,t=function(t){var n=e.width,a=e.height;t.setup=function(){t.createCanvas(n,a),t.frameRate(40)},t.draw=function(){if(t.background(0),e.signalObj){var i=e.signalObj.fft.getValue();if(i=i.slice(1,65),i){t.noStroke();for(var r=0;r<i.length;r++){var o=t.map(r,0,i.length,0,n),s=-a+t.map(i[r],-80,-20,a,0);t.fill(2*r,r,255-2*r,255),t.fill("magenta"),t.rect(o,a,n/i.length,s)}}t.noStroke(),t.fill("white"),t.textSize(10),t.textAlign(t.RIGHT),t.text(e.signalObj.name,n-3,11)}}};new te.a(t,this.$refs.canvas)}}),pe=me,ve=(n("9028"),Object(c["a"])(pe,fe,he,!1,null,"75ac7748",null)),be=ve.exports,ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div"},[n("div",{ref:"canvas"})])])},we=[],ye={name:"Scope",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{}},mounted:function(){var e=this,t=function(t){var a=e.width,i=e.height;t.setup=function(){t.createCanvas(a,i)},t.draw=function(){if(t.background(0),t.fill(255),e.signalObj){var r=e.signalObj.waveform.getValue();n(t,r,"magenta",0,0,a,i),t.noStroke(),t.textSize(10),t.textAlign(t.RIGHT),t.text(e.signalObj.name,a-3,11)}}},n=function(e,t,n,a,i,r,o){e.stroke(n),e.strokeWeight(.7);for(var s=0,c=!0,l=1;l<t.length;l++)if(c){if(t[l-1]>0&&t[l]<=0){s=l;break}}else if(t[l-1]<0&&t[l]>=0){s=l;break}t[s]=0;var u=s+t.length/2;u=s+200;for(var d=1,f=s;f<u;f++){var h=e.map(f-1,s,u,0,r),m=e.map(t[f-1]*d,-1,1,0,o),p=e.map(f,s,u,0,r),v=e.map(t[f]*d,-1,1,0,o);e.line(h+a,m+i,p+a,v+i)}};new te.a(t,this.$refs.canvas)}},ke=ye,xe=(n("68d1"),Object(c["a"])(ke,ge,we,!1,null,"481a17fc",null)),_e=xe.exports,Ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div",on:{mousedown:e.emitCallback}},[n("div",{ref:"canvas"})])])},Ce=[],Oe={name:"Button",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{result:null}},computed:{style:function(){return{width:"".concat(this.width,"px"),height:"".concat(this.height,"px")}}},methods:{emitCallback:function(){this.result=this.signalObj.callback()}},mounted:function(){var e=this,t=function(t){var n=e.width,a=e.height;t.setup=function(){t.createCanvas(n,a),t.frameRate(40)},t.draw=function(){if(e.signalObj){t.background("black"),t.fill("white"),t.noStroke(),t.fill("gray");var i=0;t.circle(t.mouseX,t.mouseY,i),t.fill("white"),t.mouseX>0&&t.mouseX<n&&t.mouseY>0&&t.mouseY<a&&(t.background("aqua"),t.cursor("pointer"),t.fill("pink"),t.circle(t.mouseX,t.mouseY,i),t.fill("black")),t.textSize(10),e.result&&(t.textAlign(t.RIGHT,t.BASELINE),t.text(e.result,n-4,a-4)),t.textAlign(t.RIGHT,t.BASELINE),t.text("button",n-3,11);var r=e.signalObj.name;r&&(t.textSize(16),t.textAlign(t.CENTER,t.CENTER),t.text(r,0,a/2,n))}}};new te.a(t,this.$refs.canvas)}},Se=Oe,je=(n("2808"),Object(c["a"])(Se,Ee,Ce,!1,null,"85b928fe",null)),Te=je.exports,Re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div",on:{mousedown:e.mouseDown,mousemove:e.mouseDrag}},[n("div",{ref:"canvas"})])])},Fe=[],Ae={name:"Slider",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{result:null,value:null,callbackCalledOnce:!1,mousedown:!1,yPosition:0}},computed:{style:function(){return{width:"".concat(this.width,"px"),height:"".concat(this.height,"px")}}},methods:{mouseDown:function(e){window.addEventListener("mouseup",this.mouseUp),this.mousedown=!0,this.mouseDrag(e)},mouseUp:function(){this.mousedown=!1,window.removeEventListener("mouseup",this.mouseUp)},mouseDrag:function(e){if(this.mousedown){var t=e.offsetY;t>this.height&&(t=this.height),t<0&&(t=0);var n=1-t/this.height;this.value=n,this.result=this.signalObj.callback(n),this.yPosition=t,this.callbackCalledOnce=!0}}},mounted:function(){var e=this,t=function(t){var n=e.width,a=e.height;t.setup=function(){t.createCanvas(n,a),t.frameRate(40)},t.draw=function(){if(e.signalObj){t.background("black"),t.fill("white"),t.noStroke(),t.fill("gray");var i=0;t.circle(t.mouseX,t.mouseY,i),t.fill("white"),t.mouseX>0&&t.mouseX<n&&t.mouseY>0&&t.mouseY<a?(t.background("black"),t.cursor("ns-resize"),t.fill("pink"),t.circle(t.mouseX,t.mouseY,i),t.fill("#666")):t.fill("#555"),e.callbackCalledOnce&&(t.fill("#555"),t.rect(0,e.yPosition,n,a-e.yPosition)),t.fill("white"),t.textSize(10),null!=e.value&&(t.textAlign(t.RIGHT,t.BASELINE),t.text(e.value.toFixed(2),n-4,a-4)),null!=e.result&&(t.textAlign(t.LEFT,t.BASELINE),t.text(e.result,3,a-4)),t.textAlign(t.RIGHT,t.BASELINE),t.text("slider",n-3,11);var r=e.signalObj.name;r&&(t.textSize(16),t.textAlign(t.CENTER,t.CENTER),t.text(r,0,a/2,n))}}};new te.a(t,this.$refs.canvas)}},Ne=Ae,Le=(n("f437"),Object(c["a"])(Ne,Re,Fe,!1,null,"484537f5",null)),De=Le.exports,Ie=(n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("2b3d"),n("9861"),n("fea2")),He=n.n(Ie),Pe=n("075e"),$e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=new AudioContext,a=new FileReader;a.onloadend=function(){var e=a.result;n.decodeAudioData(e,(function(e){var n=He()(e),a=new Uint8Array(n),i=new Pe["a"];i.fromBuffer(a),i.setTag("CODE",t),i.setTag("FRMT",JSON.stringify({format:"viztune",version:"0.1.1"}));var r=i.toBuffer(),o=new Pe["a"];o.fromBuffer(r);var s=new Blob([r],{type:"audio/wav"}),c=window.URL.createObjectURL(s),l=document.createElement("a");l.download="recording.wav",l.href=c,l.click()}))},a.readAsArrayBuffer(e)},Ve=n("d4ec"),Ue=n("bee2"),Me=(n("4de4"),n("159b"),n("f94e")),Be=n("c707"),We=n.n(Be),ze=["AmplitudeEnvelope","DCMeter","LFO","Signal","WaveShaper"],Ge=[],Ke="scope",Je="waveform",Ye="spectrum",qe="meter",Xe="button",Qe="slider",Ze=function(){function e(t){Object(Ve["a"])(this,e),this._tone=t||A,this.visuals=[],this.toneObjectDeclarations=[],this._title="Untitled"}return Object(Ue["a"])(e,[{key:"display",value:function(e,t){this.visuals.push({signal:e,name:t,type:null})}},{key:"spectrum",value:function(e,t){this.visuals.push({signal:e,name:t,type:Ye})}},{key:"scope",value:function(e,t){this.visuals.push({signal:e,name:t,type:Ke})}},{key:"waveform",value:function(e,t){this.visuals.push({signal:e,name:t,type:Je})}},{key:"meter",value:function(e,t){this.visuals.push({signal:e,name:t,type:qe})}},{key:"button",value:function(e,t){this.visuals.push({callback:e,name:t,type:Xe})}},{key:"slider",value:function(e,t){this.visuals.push({callback:e,name:t,type:Qe})}},{key:"_autoDisplay",value:function(e,t){e.connect&&this.visuals.push({signal:e,name:void 0,declarationObj:t,type:null})}},{key:"evaluateSource",value:function(e){var t=Me["parse"](e,{loc:!0}),n=[],a=t.body.filter((function(e){return"VariableDeclaration"==e.type}));a.forEach((function(e){var t,a,i,r,o,s,c=e.declarations[0].id.name,l=e.loc.start.line,u=e.loc.end.line,d="Tone"==(null===(t=e.declarations[0].init.callee)||void 0===t||null===(a=t.object)||void 0===a?void 0:a.name);"Tone"==(null===(i=e.declarations[0].init.callee)||void 0===i||null===(r=i.object)||void 0===r||null===(o=r.callee)||void 0===o||null===(s=o.object)||void 0===s?void 0:s.name)&&(d=!0),d&&n.push({identifier:c,locStart:l,locEnd:u})}));var i=[],r=t.body.filter((function(e){return"ExpressionStatement"==e.type}));r.forEach((function(e){var t,n,a="Ui"==(null===(t=e.expression.callee)||void 0===t||null===(n=t.object)||void 0===n?void 0:n.name);if(a){var r="";e.expression.arguments.length>1&&(r=e.expression.arguments[1].value);var o=e.loc.start.line,s=e.loc.end.line;i.push({label:r,locStart:o,locEnd:s})}})),this.toneObjectDeclarations=n,this.uiObjectStatements=i}},{key:"annotateVisualsLineOfCode",value:function(){var e=this,t=3,n=this.uiObjectStatements.length;this.visuals.forEach((function(a,i){if(i<t)a.locStart=null,a.locEnd=null;else if(i<t+n){var r=e.uiObjectStatements[i-t];a.locStart=r.locStart,a.locEnd=r.locEnd}else a.locStart=a.declarationObj.locStart,a.locEnd=a.declarationObj.locEnd}))}},{key:"signalObjects",get:function(){var e=this,t=[];return this.annotateVisualsLineOfCode(),this.visuals.length>0&&(t=this.visuals.map((function(t){if(t.type==Xe)return t;if(t.type==Qe)return t;if(t.type||(t.type=Ke,ze.includes(t.signal.name)&&(t.type=Je),Ge.includes(t.signal.name)&&(t.type=Ye)),"Param"==t.signal.name)return{renderValue:function(e){return e.value},signal:t.signal,name:t.name||t.signal.name,type:Je,locStart:t.locStart,locEnd:t.locEnd};if(t.type==Je){var n=new e._tone.Meter({normalRange:!0});return t.signal.connect(n),{meter:n,name:t.name||t.signal.name,type:Je,locStart:t.locStart,locEnd:t.locEnd}}if(t.type==Ye){var a=new e._tone.Mono,i=new e._tone.Analyser({type:"fft",size:512,channels:1});return a.connect(i),t.signal.connect(a),{fft:i,name:t.name||t.signal.name,type:Ye,locStart:t.locStart,locEnd:t.locEnd}}if(t.type==Ke){var r=new e._tone.Mono,o=new e._tone.Analyser({type:"waveform",size:512,smoothing:.9,channels:1});return r.connect(o),t.signal.connect(r),{waveform:o,name:t.name||t.signal.name,type:Ke,locStart:t.locStart,locEnd:t.locEnd}}if(t.type==qe){var s=new e._tone.Meter({channels:2,smoothing:0});return s.normalRange=!0,t.signal.connect(s),{meter:s,name:t.name||t.signal.name,type:qe,locStart:t.locStart,locEnd:t.locEnd}}}))),t=We()(t,(function(e){return e.locStart?e.locStart:-1})),t}}]),e}(),et=(n("7d3a"),n("2ef0")),tt=n.n(et),nt=n("8a60"),at=n.n(nt),it="14.7.77",rt={name:"Editor",components:{Header:$,Footer:z,Meter:re,Waveform:de,Spectrum:be,Scope:_e,Slider:De,Button:Te,Notification:X},props:{},data:function(){return{editor:null,output:null,text:"",lastExecutedText:"",windowWidth:100,windowHeight:1e3,headerHeight:54,footerHeight:40,editorLeft:400,hasError:!1,errorName:"name",errorLine:0,errorMessage:"",signalObjects:[],visualSizes:{small:[120,90],medium:[185,138],large:[380,90]},visualSize:"small",cursorLineNumber:0,decorations:null,recording:!1}},computed:{visualsWidth:function(){return this.visualSizes[this.visualSize][0]},visualsHeight:function(){return this.visualSizes[this.visualSize][1]},editorStyle:function(){var e=this.windowHeight-this.headerHeight-this.footerHeight,t=this.windowWidth-this.editorLeft,n={left:"".concat(this.editorLeft,"px"),width:"".concat(t,"px"),height:"".concat(e,"px"),backgroundColor:"black"};return n},visualsStyle:function(){var e=this.windowHeight-this.headerHeight-this.footerHeight;return{left:"0px",width:"".concat(this.editorLeft,"px"),height:"".concat(e,"px"),"grid-template-columns":"repeat(auto-fill, ".concat(this.visualsWidth,"px)"),"grid-auto-rows":"".concat(this.visualsHeight,"px"),backgroundColor:"teal"}},hasUnappliedChanges:function(){return this.text!=this.lastExecutedText}},beforeDestroy:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.closeContext();case 2:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;this.text=this.$store.getters.activeFile.code,this.loadDefinition(),at.a.bind("command+s",(function(){return e.$store.dispatch("saveCurrentToFile"),!1})),at.a.bind("command+return",(function(){return e.emitChange(),!1})),at.a.bind("command+o",(function(){return e.$store.dispatch("openFile"),!1})),at.a.bind("command+.",(function(){return e.closeContext(),!1}))},methods:{createEditor:function(){var e=this,t=this.$refs.editor,a=F["editor"].createModel(this.text,"typescript");this.editor=F["editor"].create(t,{model:a,theme:"vs-dark",scrollBeyondLastLine:!1,multiCursorModifier:"ctrlCmd",minimap:{enabled:!1},lineNumbers:"on"}),this.$store.commit("setEditorReference",this.editor),F["editor"].defineTheme("transparentBgTheme",{base:"vs-dark",inherit:!0,rules:[{background:"000000"}],colors:{"editor.background":"#000000",peekWidgetDefaultFocus:"tree"}}),F["editor"].setTheme("transparentBgTheme"),F["languages"].registerDocumentFormattingEditProvider("typescript",{provideDocumentFormattingEdits:function(e,t,a){return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.e("chunk-2d0b9262").then(n.t.bind(null,"325b",7));case 2:return a=t.sent,t.next=5,n.e("chunk-2d0ceaf4").then(n.t.bind(null,"6103",7));case 5:return i=t.sent,r=a.format(e.getValue(),{parser:"babel",plugins:[i],singleQuote:!1,printWidth:80}),t.abrupt("return",[{range:e.getFullModelRange(),text:r}]);case 8:case"end":return t.stop()}}),t)})))()}}),F["languages"].typescript.typescriptDefaults.setCompilerOptions({target:F["languages"].typescript.ScriptTarget.ES2015,allowNonTsExtensions:!0,lib:["ES2015"]}),F["languages"].typescript.typescriptDefaults.addExtraLib(this.declr,"file:///node_modules/tone/index.d.ts"),F["languages"].typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!0}),F["languages"].typescript.javascriptDefaults.setCompilerOptions({noLib:!1,allowNonTsExtensions:!0,lib:["es2019"]}),this.editor._standaloneKeybindingService.addDynamicKeybinding("-editor.action.quickFix",null,(function(){})),this.editor.onDidChangeModelContent((function(){var t=e.editor.getValue();e.text!==t&&(e.text=t)})),this.editor.onDidChangeCursorPosition((function(){e.cursorLineNumber=e.editor.getPosition().lineNumber}));var i=this;this.editor.addCommand(F["KeyMod"].CtrlCmd|F["KeyCode"].Enter,(function(){i.emitChange()})),this.editor.addCommand(F["KeyMod"].CtrlCmd|F["KeyCode"].KEY_S,(function(){i.$store.dispatch("saveCurrentToFile")})),this.editor.addCommand(F["KeyMod"].CtrlCmd|F["KeyCode"].US_DOT,(function(){i.closeContext()})),this.editor.addCommand(F["KeyMod"].CtrlCmd|F["KeyCode"].KEY_O,(function(){i.$store.dispatch("openFile")})),window.addEventListener("resize",(function(){i.resize()})),i.resize()},emitChange:function(){var e=this,t=A["getContext"](),n=new A["Context"];A["setContext"](n),this.toneContext=n,A["start"]();var a=this;this.editor.getAction("editor.action.formatDocument").run().then((function(){a.startFunction(),a.$store.dispatch("updateCode",e.text),a.hasError=!1,t&&"closed"!=t.state&&t.close()})).catch((function(e){if(a.hasError=!0,a.errorName=e.name,e.stack.includes("<anonymous>:")){var n=parseInt(e.stack.split("<anonymous>:")[1].split(":")[0],10);a.errorLine=n-2}a.errorMessage=e.message,A["setContext"](t),a.toneContext=t}))},closeContext:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.toneContext){t.next=5;break}return t.next=3,e.toneContext.close();case 3:e.toneContext=null,e.$store.commit("setIsNotRunning");case 5:case"end":return t.stop()}}),t)})))()},startFunction:function(){var e=new Ze(A),t=A["getDestination"]();if(e.meter(t,"Main"),e.spectrum(t,"Main"),e.scope(t,"Main"),this.recording){this.recording=!1;var n=new A["Recorder"];t.connect(n),n.start();var a=10,i=this;setTimeout(Object(d["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.stop();case 2:t=e.sent,$e(t,"codetext"),i.closeContext();case 5:case"end":return e.stop()}}),e)}))),1e3*a)}var r=this.text.replaceAll("Tone.Transport","Tone.getTransport()");r+="\n      Ui.toneObjectDeclarations.forEach((i) => {\n        Ui._autoDisplay(eval(i.identifier), i);\n      });",e.evaluateSource(r),r+="\n        // Run at the end of the function code.\n        const addCompressorToChain = true;\n        // Add an aggressive compressor as a limiter for user safety.\n        // Requires patched Tone.js.\n        const __destination = Tone.getDestination();\n        const __compressor = new Tone.Compressor({\n          attack: 0,\n          knee: 0,\n          ratio: 20,\n          release: 0.5,\n          threshold: 0,\n        });\n        if(__destination.chainItems){\n            const __chainItems = [...__destination.chainItems];\n            __chainItems.forEach(n => n.disconnect());\n            __chainItems.push(__compressor);\n            __destination.chain(...__chainItems);\n        }else{\n          console.warn(\"Tone.js is unpatched. Missing destination.chainItems.\");\n        }\n        if (typeof title !== 'undefined'){\n          Ui._title = title;\n        }\n      ",new Function("Tone","Tonal","_","CodeWarbler","Ui",r)(A,N,tt.a,e,e),this.signalObjects=e.signalObjects,this.$store.commit("setIsRunning"),this.$store.dispatch("updateTitle",e._title),this.lastExecutedText=this.text},loadDefinition:function(){var e="https://tonejs.github.io/docs/".concat(it,"/assets/tone.d.ts"),t=this;fetch(e).then((function(e){return e.text()})).then((function(e){e=e.replace("declare module 'tone' {","namespace Tone {"),e+="\ninterface Console {\n  log(message?: any, ...optionalParams: any[]): void;\n}\ndeclare var Console: {\n  prototype: Console;\n  new(): Console;\n};\nconst console = new Console();\n\n// Declaration for Ui needs to be completed by hand here.\n/**\n* Ui object\n*/\nnamespace Ui {\n      /**\n      * Make the display.\n      */\n      declare function display(signal: any, label?: string): void;\n      /**\n      * Make the scope.\n      */\n      declare function scope(signal: any, label?: string): void;\n      /**\n      * Make the meter.\n      */\n      declare function meter(signal: any, label?: string): void;\n      /**\n      * Make the waveform.\n      */\n      declare function waveform(signal: any, label?: string): void;\n      /**\n      * Make the spectrum.\n      */\n      declare function spectrum(signal: any, label?: string): void;\n      /**\n      * Make the button.\n      */\n      declare function button(onClickedFunction: () => string, label?: string): void;\n      /**\n      * Make the slider.\n      */\n      declare function slider(onChangedFunction: (value) => string, label?: string): void;\n}\n\n\n",t.declr=e,t.createEditor()}))},resize:function(){this.windowWidth=document.documentElement.clientWidth,this.windowHeight=window.innerHeight;var e=this;this.$nextTick((function(){e.editor.layout()}))},isLineActive:function(e){return this.cursorLineNumber>=e.locStart&&this.cursorLineNumber<=e.locEnd&&null!=e.locStart},makeLinesActive:function(e){e.locStart&&(this.decorations=this.editor.deltaDecorations(this.decorations||[],[{range:new F["Range"](e.locStart,1,e.locEnd,1),options:{isWholeLine:!0,linesDecorationsClassName:"lineHighlightDecoration"}}]))},makeLinesInactive:function(){this.decorations&&(this.decorations=this.editor.deltaDecorations(this.decorations,[]))},record:function(){this.recording=!0,this.emitChange()}}},ot=rt,st=(n("58d3"),Object(c["a"])(ot,T,R,!1,null,null,null)),ct=st.exports;a["a"].use(j["a"]);var lt=[{path:"/",component:ct}],ut=new j["a"]({mode:"history",base:"/warbler/".concat("0.1","/"),routes:lt}),dt=ut;a["a"].config.productionTip=!1,new a["a"]({store:S,router:dt,render:function(e){return e(u)}}).$mount("#app")},"58d3":function(e,t,n){"use strict";n("f08e")},"62fc":function(e,t,n){},"68d1":function(e,t,n){"use strict";n("d9c3")},"709a":function(e,t,n){"use strict";n("a3aa")},8521:function(e,t,n){},"85ec":function(e,t,n){},9028:function(e,t,n){"use strict";n("0f4e")},a3aa:function(e,t,n){},af27:function(e,t,n){"use strict";n("2eef")},b0d0:function(e,t,n){},d9c3:function(e,t,n){},f08e:function(e,t,n){},f437:function(e,t,n){"use strict";n("b0d0")}});
//# sourceMappingURL=app.dbd66344.js.map