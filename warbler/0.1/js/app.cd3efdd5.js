(function(e){function t(t){for(var i,o,s=t[0],c=t[1],l=t[2],u=0,f=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);d&&d(t);while(f.length)f.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(i=!1)}i&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},a={app:0},r=[];function o(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-0b65ffb6":"f67fdb85","chunk-2d0a3196":"525c060a","chunk-2d0a3577":"08e57b7c","chunk-2d0a40c8":"f1e3a7bf","chunk-2d0a43df":"29246f68","chunk-2d0aa90c":"7dcadb75","chunk-2d0aab07":"b4bc5fcb","chunk-2d0abc00":"d579495e","chunk-2d0ae937":"972e1caf","chunk-2d0aeb45":"a7da3444","chunk-2d0af08c":"13b9cb9b","chunk-2d0afa49":"0d8775c1","chunk-2d0b2762":"040008b6","chunk-2d0b6187":"98b8f6c5","chunk-2d0b9262":"1a722d96","chunk-2d0ba136":"1c2c79ef","chunk-2d0bb267":"e21a8941","chunk-2d0bcec1":"04eac3a4","chunk-2d0bdf38":"484e3585","chunk-2d0bff92":"aeb10dc4","chunk-2d0c0494":"fc8dc4d1","chunk-2d0c0a09":"ccdaf638","chunk-2d0c4313":"e8a59f53","chunk-2d0c46d1":"26a18d3e","chunk-2d0c4a95":"8524702c","chunk-2d0c512b":"6432da8e","chunk-2d0c86e3":"3ad7a61f","chunk-2d0c8f4c":"e8ca8a7d","chunk-2d0ceaf4":"fb6a929a","chunk-2d0cf16e":"a58b5444","chunk-2d0d056d":"b352fd49","chunk-2d0d0645":"294ff97f","chunk-2d0d2f22":"002f49f5","chunk-2d0d61fd":"5f2f813d","chunk-2d0d7e63":"3693fe03","chunk-2d0dda4e":"0781d70a","chunk-2d0de971":"0f33a456","chunk-2d0e1b57":"ac0499f6","chunk-2d0e1fbe":"165f4253","chunk-2d0e22d6":"b9b3c7cb","chunk-2d0e4fe5":"5562afa2","chunk-2d0e542a":"444e1c4d","chunk-2d0e57ec":"b32f338b","chunk-2d0e6553":"59054791","chunk-2d0e6c86":"e4bfd896","chunk-2d0ea098":"ac843613","chunk-2d0f0a11":"81a52aab","chunk-2d208ac5":"6742d98f","chunk-2d209408":"344ac544","chunk-2d20f745":"ad4a1523","chunk-2d20ff23":"cb2eb94f","chunk-2d2138c7":"ef6bd49e","chunk-2d216f3b":"eeb0926e","chunk-2d217e5b":"b529a5b7","chunk-2d21b84a":"a58793d6","chunk-2d21dcd2":"36d54505","chunk-2d21f327":"0b267cb0","chunk-2d2214b3":"147874bc","chunk-2d221799":"ca7947fb","chunk-2d221814":"9c3abd2b","chunk-2d221a34":"1eda6924","chunk-2d22502a":"11dd15f9","chunk-2d226775":"c0469318","chunk-2d229411":"85262941","chunk-2d2295e9":"c6cb51d6","chunk-2d22c171":"fb2a7e19","chunk-2d22c2b8":"8b8784b2","chunk-2d22ca58":"7ca668b9","chunk-2d2311f7":"b12123d9","chunk-2d237ee7":"12ce153c","chunk-2d238465":"9c277db1","chunk-30597b4a":"a438a431","chunk-7532b3ea":"0c75ed04","chunk-e13e4362":"38cf6ebf"}[e]+".js"}function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,i){n=a[e]=[t,i]}));t.push(n[2]=i);var r,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=o(e);var l=new Error;r=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=a[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",l.name="ChunkLoadError",l.type=i,l.request=r,n[1](l)}a[e]=void 0}};var u=setTimeout((function(){r({type:"timeout",target:c})}),12e4);c.onerror=c.onload=r,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/warbler/0.1/",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"012a":function(e,t,n){"use strict";n("5407")},"034f":function(e,t,n){"use strict";n("85ec")},"054c":function(e,t,n){},"0f4e":function(e,t,n){},"120c":function(e,t,n){"use strict";n("054c")},2808:function(e,t,n){"use strict";n("8521")},"2eef":function(e,t,n){},5407:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.$store.state.fileLoaded?n("router-view"):e._e()],1)},r=[],o={name:"App",components:{},mounted:function(){var e=this.$route.query.d;e?this.$store.dispatch("loadFromQueryString",e):this.$store.dispatch("loadFileFromBrowser")}},s=o,c=(n("034f"),n("2877")),l=Object(c["a"])(s,a,r,!1,null,null,null),u=l.exports,d=n("1da1"),f=(n("96cf"),n("b0c0"),n("e9c4"),n("99af"),n("2f62")),h=n("a002"),m=n.n(h),p=n("b047c"),v=n.n(p),b=n("a80f"),g=n("b138");i["a"].use(f["a"]);var w="CodeWarbler/warbler",y="activeFile",k='// Libraries available: Tone.js 14.7.77, Tonal.js 4.6.5, Lodash 4.17.21\nconst title = "Untitled file";\n\n// Create a Tone.js oscillator\nvar t = new Tone.Oscillator(400);\nt.volume.value = -12;\nt.start();\nt.toDestination();',x=1e3,_=v()((function(e){window.history.replaceState({},null,e)}),x),E=new f["a"].Store({state:{forage:null,fileLoaded:!1,queryFile:{},isQueryFile:!1,browserFile:{},fileHandle:null,fileSystemProjectId:"warbler",data:{},editorReference:null,alertId:0,alertHeading:"",alertDescription:"",isRunning:!1},mutations:{setEditorReference:function(e,t){e.editorReference=t},setAlert:function(e,t){"fileSave"==t&&(e.alertHeading="File Saved",e.alertDescription="".concat(e.fileHandle.name," was updated.")),e.alertId=Math.random()},setIsRunning:function(e){e.isRunning=!0},setIsNotRunning:function(e){e.isRunning=!1}},getters:{activeFile:function(e){return e.isQueryFile?e.queryFile:e.data},fileAsJson:function(e){return JSON.stringify(e.data)},fileName:function(e){var t;return null===(t=e.fileHandle)||void 0===t?void 0:t.name}},actions:{openFile:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var n,i,a,r,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.state,g["c"],i={extensions:[".codewarbler"],multiple:!1,description:"CodeWarbler files",id:n.fileSystemProjectId,excludeAcceptAllOption:!1},t.next=5,Object(g["a"])(i);case 5:return a=t.sent,n.fileHandle=a.handle,t.next=9,n.fileHandle.getFile();case 9:return r=t.sent,t.next=12,r.text();case 12:o=t.sent,s=JSON.parse(o),n.data=s,n.editorReference.getModel().setValue(s.code);case 16:case"end":return t.stop()}}),t)})))()},saveFileToSystem:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var n,i,a,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.state,i=e.dispatch,a=e.getters,r=e.commit,n.fileHandle){t.next=3;break}return t.abrupt("return",i("saveFileToSystemAsNew"));case 3:return o=new Blob([a.fileAsJson],{}),t.next=6,Object(g["b"])(o,{fileName:n.fileHandle.name,description:"CodeWarbler file",extensions:["codewarbler"]},n.fileHandle);case 6:r("setAlert","fileSave");case 7:case"end":return t.stop()}}),t)})))()},saveFileToSystemAsNew:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var n,i,a,r,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.state,i=e.getters,a=e.commit,r=new Blob([i.fileAsJson],{type:"text/json"}),o=n.data.filename||"Untitled.codewarbler",t.next=5,Object(g["b"])(r,{fileName:o,description:"CodeWarbler file",extensions:[".codewarbler"],id:n.fileSystemProjectId},null);case 5:s=t.sent,n.fileHandle=s,a("setAlert","fileSave");case 8:case"end":return t.stop()}}),t)})))()},loadFileFromBrowser:function(e){var t=e.state,n=e.dispatch;return t.forage||(t.forage=m.a.createInstance({name:w})),t.forage.getItem(y).then((function(e){e=e?{id:y,data:e}:{id:y,data:{code:k,title:"Untitled file",datetime:Date.now()}},t.browserFile=e,t.data=e.data,n("updatePageTitle"),t.fileLoaded=!0}))},loadFromQueryString:function(e,t){var n=e.state,i=e.dispatch,a=JSON.parse(Object(b["b"])(t));"data"in a&&(a=a.data),n.queryFile=a,n.isQueryFile=!0,n.fileLoaded=!0,i("updatePageTitle")},saveCurrentToFile:function(e){var t=e.getters,n=e.dispatch,i=t.activeFile;n("saveFile",i),n("saveFileToSystem")},updateCode:function(e,t){var n=e.getters,i=e.dispatch,a=n.activeFile;a.code=t,i("saveFile",a)},updateTitle:function(e,t){var n=e.getters,i=e.dispatch,a=n.activeFile;t!=a.title&&(a.title=t,i("saveFile",a))},saveFile:function(e,t){var n=e.state,i=e.getters,a=e.dispatch;if(t.datetime=Date.now(),t.title||(t.title=t.name),delete t.name,delete t.snippet,t.libraryName="Tone.js",t.libraryVersion=Object({NODE_ENV:"production",VUE_APP_WARBLER_VERSION:"0.1",VUE_APP_TONE_DEFINITIONS_VERSION:"14.7.77",VUE_APP_GIT_REV:"771758e",VUE_APP_BUILD_DATE:"1647717417660",BASE_URL:"/warbler/0.1/"}).VUE_APP_TONE_VERSION,t.appName="warbler",t.appVersion="0.1",n.fileHandle&&(t.filename=n.fileHandle.name),a("updatePageTitle"),n.data=t,n.isQueryFile){var r=JSON.stringify(i.activeFile),o=Object(b["a"])(r),s="".concat(window.location.pathname,"?d=").concat(o);_(s)}else n.forage.setItem(y,t).then((function(e){})).catch((function(e){}))},gotoPermanentUrl:function(e){var t=e.getters,n=JSON.stringify(t.activeFile),i=Object(b["a"])(n),a="https://codewarbler.github.io/warbler/".concat("0.1","/?d=").concat(i);window.open(a,"_blank")},updatePageTitle:function(e){var t=e.getters;document.title="".concat(t.activeFile.title," - CodeWarbler")}}}),C=n("8c4f"),O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editor-component"},[n("Header",{staticClass:"header",attrs:{"unapplied-changes":e.hasUnappliedChanges},on:{startFunction:e.emitChange,closeContext:e.closeContext}}),n("div",{staticClass:"visuals",style:e.visualsStyle},[e._l(e.signalObjects,(function(t,i){return n("div",{key:t.name+i,class:{active:e.isLineActive(t)},on:{mouseover:function(n){return e.makeLinesActive(t)},mouseleave:function(n){return e.makeLinesInactive(t)}}},["scope"==t.type?n("Scope",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e(),"spectrum"==t.type?n("Spectrum",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e(),"waveform"==t.type?n("Waveform",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e(),"meter"==t.type?n("Meter",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e(),"button"==t.type?n("Button",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e(),"slider"==t.type?n("Slider",{attrs:{"signal-obj":t,width:e.visualsWidth,height:e.visualsHeight}}):e._e()],1)})),e.hasError?n("div",{staticClass:"error"},[n("h1",[e._v(e._s(e.errorName))]),n("p",[e._v("Near line number "+e._s(e.errorLine))]),n("code",[e._v(e._s(e.errorMessage))])]):e._e()],2),n("div",{ref:"editor",staticClass:"editor",style:e.editorStyle}),n("Footer",{staticClass:"footer"}),n("Notification",{staticClass:"notification"})],1)},S=[],j=(n("b64b"),n("d3b7"),n("3ca3"),n("ddb0"),n("caad"),n("2532"),n("ac1f"),n("1276"),n("5319"),n("5b81"),n("c2c6")),T=n("5e54"),F=n("772f"),R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header"},[n("div",{staticClass:"left"},[n("span",{staticClass:"heading-1"},[e._v("Warbler ")]),n("span",[e._v(e._s(e.$store.getters["fileName"]))])]),n("div",{staticClass:"center"},[n("div",[n("button",{class:{active:e.$store.state.isRunning,unapplied:e.unappliedChanges},on:{click:e.startFunction}},[e._v(" Run ")]),n("button",{class:{active22:!e.$store.state.isRunning},on:{click:e.closeContext}},[e._v(" Stop ")]),n("button",{on:{click:function(t){return e.$store.dispatch("openFile")}}},[e._v("Load")]),n("button",{on:{click:function(t){return e.$store.dispatch("saveFileToSystem")}}},[e._v("Export")]),n("button",{on:{click:function(t){return e.$store.dispatch("gotoPermanentUrl")}}},[e._v(" Permanent Link ")])])])])},A=[],N={name:"Header",props:{unappliedChanges:{type:Boolean,default:function(){return!1}}},data:function(){return{version:"0.1"}},methods:{startFunction:function(){this.$emit("startFunction")},closeContext:function(){this.$emit("closeContext")}}},I=N,L=(n("9eae"),Object(c["a"])(I,R,A,!1,null,"78c7de7c",null)),D=L.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"footer-container"},[e._m(0),n("div",{staticClass:"right"},[e._m(1),n("span",[n("abbr",{attrs:{title:"Build "+e.VUE_APP_GIT_REV+" from "+e.VUE_APP_BUILD_DATE}},[e._v(" Warbler "+e._s(e.VUE_APP_WARBLER_VERSION)+" ")])])])])},H=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"left"},[n("a",{attrs:{href:"https://codewarbler.github.io/#warbler"}},[e._v("About")]),n("a",{attrs:{href:"https://codewarbler.github.io/warbler/#examples"}},[e._v("Examples")]),n("a",{attrs:{href:"https://github.com/codewarbler/warbler"}},[e._v("Github")]),n("a",{attrs:{href:"https://twitter.com/codewarbler"}},[e._v("Twitter")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"quickkeys"},[n("b",[e._v("Run:")]),e._v(" Cmd + Return "),n("b",[e._v("Stop: ")]),e._v(" Cmd + . ")])}],$={name:"Footer",data:function(){var e=new Date(parseInt("1647717417660",10));return{VUE_APP_WARBLER_VERSION:"0.1",VUE_APP_BUILD_DATE:e.toUTCString(),VUE_APP_GIT_REV:"771758e"}}},V=$,M=(n("af27"),Object(c["a"])(V,P,H,!1,null,"e08ce656",null)),U=M.exports,W=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"notification-container"},[n("Transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:e.alerting,expression:"alerting"}],staticClass:"alert-container"},[n("h1",[e._v(e._s(e.$store.state.alertHeading))]),n("p",[e._v(e._s(e.$store.state.alertDescription))])])])],1)},B=[],z={name:"Notification",data:function(){return{alerting:!1}},computed:{alertId:function(){return this.$store.state.alertId}},watch:{alertId:function(){this.triggerAlert()}},mounted:function(){},methods:{triggerAlert:function(){var e=this;this.alerting=!0,setTimeout((function(){e.alerting=!1}),1e3)}}},G=z,K=(n("012a"),Object(c["a"])(G,W,B,!1,null,"2be0532f",null)),Y=K.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div"},[n("div",{ref:"canvas"})])])},q=[],X=(n("a9e3"),n("cb29"),n("b680"),n("3425")),Q=n.n(X),Z={name:"Meter",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{}},mounted:function(){var e=this,t=function(t){var n=e.width,i=e.height;t.setup=function(){t.createCanvas(n,i),t.frameRate(40)},t.draw=function(){if(e.signalObj){t.background(0),t.fill("magenta");var a=n/2,r=e.signalObj.meter.getValue()[0],o=e.signalObj.meter.getValue()[1],s=(n-a)/2-1,c=n/2+1;t.rect(s,i-r*i,a/2,i+20),t.rect(c,i-o*i,a/2,i+20),t.fill("white"),t.textSize(10);var l=2;t.textAlign(t.LEFT),t.text(r.toFixed(l),3,i-4),t.textAlign(t.RIGHT),t.text(o.toFixed(l),n-4,i-4),t.textSize(10),t.textAlign(t.RIGHT),t.text(e.signalObj.name,n-3,11)}}};new Q.a(t,this.$refs.canvas)}},ee=Z,te=(n("120c"),Object(c["a"])(ee,J,q,!1,null,"45890268",null)),ne=te.exports,ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div"},[n("div",{ref:"canvas"})])])},ae=[],re={name:"Waveform",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{values:[],min:null,max:null}},mounted:function(){var e=this;this.values=new Array(e.width).fill(0);var t=function(t){var n=0,i=e.width,a=e.height;t.setup=function(){t.createCanvas(i,a),t.frameRate(30)},t.draw=function(){if(e.signalObj){var r;t.background(0),t.stroke("#00adad"),r=e.signalObj.renderValue?e.signalObj.renderValue(e.signalObj.signal):e.signalObj.meter.getValue(),(null==e.min||e.min>r)&&(e.min=r),(null==e.max||e.max<r)&&(e.max=r);var o=e.min,s=e.max;e.signalObj.approxValue&&(r=e.signalObj.approxValue);var c=1-(r-o)/(s-o),l=c*a;e.values.shift(),e.values.push(l);for(var u=0;u<e.values.length;u++)t.line(n+u,e.values[u],n+u,a);t.fill("white"),t.textSize(10);var d=2;t.textAlign(t.LEFT),t.text(e.max.toFixed(d),3,11),t.text(e.min.toFixed(d),3,a-4),t.textSize(10),t.textAlign(t.RIGHT),t.text(r.toFixed(d),i-4,a-4),t.textAlign(t.RIGHT),t.text(e.signalObj.name,i-3,11)}}};new Q.a(t,this.$refs.canvas)}},oe=re,se=(n("709a"),Object(c["a"])(oe,ie,ae,!1,null,"007d9584",null)),ce=se.exports,le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div"},[n("div",{ref:"canvas"})])])},ue=[],de=(n("fb6a"),n("d81d"),{name:"Spectrum",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{}},mounted:function(){var e=this,t=function(t){var n=e.width,i=e.height;t.setup=function(){t.createCanvas(n,i),t.frameRate(40)},t.draw=function(){if(t.background(0),e.signalObj){var a=e.signalObj.fft.getValue();if(a=a.slice(1,65),a){t.noStroke();for(var r=0;r<a.length;r++){var o=t.map(r,0,a.length,0,n),s=-i+t.map(a[r],-80,-20,i,0);t.fill(2*r,r,255-2*r,255),t.fill("magenta"),t.rect(o,i,n/a.length,s)}}t.noStroke(),t.fill("white"),t.textSize(10),t.textAlign(t.RIGHT),t.text(e.signalObj.name,n-3,11)}}};new Q.a(t,this.$refs.canvas)}}),fe=de,he=(n("9028"),Object(c["a"])(fe,le,ue,!1,null,"75ac7748",null)),me=he.exports,pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div"},[n("div",{ref:"canvas"})])])},ve=[],be={name:"Scope",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{}},mounted:function(){var e=this,t=function(t){var i=e.width,a=e.height;t.setup=function(){t.createCanvas(i,a)},t.draw=function(){if(t.background(0),t.fill(255),e.signalObj){var r=e.signalObj.waveform.getValue();n(t,r,"magenta",0,0,i,a),t.noStroke(),t.textSize(10),t.textAlign(t.RIGHT),t.text(e.signalObj.name,i-3,11)}}},n=function(e,t,n,i,a,r,o){e.stroke(n),e.strokeWeight(.7);for(var s=0,c=!0,l=1;l<t.length;l++)if(c){if(t[l-1]>0&&t[l]<=0){s=l;break}}else if(t[l-1]<0&&t[l]>=0){s=l;break}t[s]=0;var u=s+t.length/2;u=s+200;for(var d=1,f=s;f<u;f++){var h=e.map(f-1,s,u,0,r),m=e.map(t[f-1]*d,-1,1,0,o),p=e.map(f,s,u,0,r),v=e.map(t[f]*d,-1,1,0,o);e.line(h+i,m+a,p+i,v+a)}};new Q.a(t,this.$refs.canvas)}},ge=be,we=(n("68d1"),Object(c["a"])(ge,pe,ve,!1,null,"481a17fc",null)),ye=we.exports,ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div",on:{mousedown:e.emitCallback}},[n("div",{ref:"canvas"})])])},xe=[],_e={name:"Button",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{result:null}},computed:{style:function(){return{width:"".concat(this.width,"px"),height:"".concat(this.height,"px")}}},methods:{emitCallback:function(){this.result=this.signalObj.callback()}},mounted:function(){var e=this,t=function(t){var n=e.width,i=e.height;t.setup=function(){t.createCanvas(n,i),t.frameRate(40)},t.draw=function(){if(e.signalObj){t.background("black"),t.fill("white"),t.noStroke(),t.fill("gray");var a=0;t.circle(t.mouseX,t.mouseY,a),t.fill("white"),t.mouseX>0&&t.mouseX<n&&t.mouseY>0&&t.mouseY<i&&(t.background("aqua"),t.cursor("pointer"),t.fill("pink"),t.circle(t.mouseX,t.mouseY,a),t.fill("black")),t.textSize(10),e.result&&(t.textAlign(t.RIGHT,t.BASELINE),t.text(e.result,n-4,i-4)),t.textAlign(t.RIGHT,t.BASELINE),t.text("button",n-3,11);var r=e.signalObj.name;r&&(t.textSize(16),t.textAlign(t.CENTER,t.CENTER),t.text(r,0,i/2,n))}}};new Q.a(t,this.$refs.canvas)}},Ee=_e,Ce=(n("2808"),Object(c["a"])(Ee,ke,xe,!1,null,"85b928fe",null)),Oe=Ce.exports,Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"canvas-div",on:{mousedown:e.mouseDown,mousemove:e.mouseDrag}},[n("div",{ref:"canvas"})])])},je=[],Te={name:"Slider",props:{signalObj:{type:Object,default:function(){}},width:{type:Number,default:function(){return 160}},height:{type:Number,default:function(){return 100}}},data:function(){return{result:null,value:null,callbackCalledOnce:!1,mousedown:!1,yPosition:0}},computed:{style:function(){return{width:"".concat(this.width,"px"),height:"".concat(this.height,"px")}}},methods:{mouseDown:function(e){window.addEventListener("mouseup",this.mouseUp),this.mousedown=!0,this.mouseDrag(e)},mouseUp:function(){this.mousedown=!1,window.removeEventListener("mouseup",this.mouseUp)},mouseDrag:function(e){if(this.mousedown){var t=e.offsetY;t>this.height&&(t=this.height),t<0&&(t=0);var n=1-t/this.height;this.value=n,this.result=this.signalObj.callback(n),this.yPosition=t,this.callbackCalledOnce=!0}}},mounted:function(){var e=this,t=function(t){var n=e.width,i=e.height;t.setup=function(){t.createCanvas(n,i),t.frameRate(40)},t.draw=function(){if(e.signalObj){t.background("black"),t.fill("white"),t.noStroke(),t.fill("gray");var a=0;t.circle(t.mouseX,t.mouseY,a),t.fill("white"),t.mouseX>0&&t.mouseX<n&&t.mouseY>0&&t.mouseY<i?(t.background("black"),t.cursor("ns-resize"),t.fill("pink"),t.circle(t.mouseX,t.mouseY,a),t.fill("#666")):t.fill("#555"),e.callbackCalledOnce&&(t.fill("#555"),t.rect(0,e.yPosition,n,i-e.yPosition)),t.fill("white"),t.textSize(10),null!=e.value&&(t.textAlign(t.RIGHT,t.BASELINE),t.text(e.value.toFixed(2),n-4,i-4)),null!=e.result&&(t.textAlign(t.LEFT,t.BASELINE),t.text(e.result,3,i-4)),t.textAlign(t.RIGHT,t.BASELINE),t.text("slider",n-3,11);var r=e.signalObj.name;r&&(t.textSize(16),t.textAlign(t.CENTER,t.CENTER),t.text(r,0,i/2,n))}}};new Q.a(t,this.$refs.canvas)}},Fe=Te,Re=(n("f437"),Object(c["a"])(Fe,Se,je,!1,null,"484537f5",null)),Ae=Re.exports,Ne=n("d4ec"),Ie=n("bee2"),Le=(n("4de4"),n("159b"),n("f94e")),De=n("c707"),Pe=n.n(De),He=["AmplitudeEnvelope","DCMeter","LFO","Signal","WaveShaper"],$e=[],Ve="scope",Me="waveform",Ue="spectrum",We="meter",Be="button",ze="slider",Ge=function(){function e(t){Object(Ne["a"])(this,e),this._tone=t||T,this.visuals=[],this.toneObjectDeclarations=[],this._title="Untitled"}return Object(Ie["a"])(e,[{key:"display",value:function(e,t){this.visuals.push({signal:e,name:t,type:null})}},{key:"spectrum",value:function(e,t){this.visuals.push({signal:e,name:t,type:Ue})}},{key:"scope",value:function(e,t){this.visuals.push({signal:e,name:t,type:Ve})}},{key:"waveform",value:function(e,t){this.visuals.push({signal:e,name:t,type:Me})}},{key:"meter",value:function(e,t){this.visuals.push({signal:e,name:t,type:We})}},{key:"button",value:function(e,t){this.visuals.push({callback:e,name:t,type:Be})}},{key:"slider",value:function(e,t){this.visuals.push({callback:e,name:t,type:ze})}},{key:"_autoDisplay",value:function(e,t){e.connect&&this.visuals.push({signal:e,name:void 0,declarationObj:t,type:null})}},{key:"evaluateSource",value:function(e){var t=Le["parse"](e,{loc:!0}),n=[],i=t.body.filter((function(e){return"VariableDeclaration"==e.type}));i.forEach((function(e){var t,i,a,r,o,s,c=e.declarations[0].id.name,l=e.loc.start.line,u=e.loc.end.line,d="Tone"==(null===(t=e.declarations[0].init.callee)||void 0===t||null===(i=t.object)||void 0===i?void 0:i.name);"Tone"==(null===(a=e.declarations[0].init.callee)||void 0===a||null===(r=a.object)||void 0===r||null===(o=r.callee)||void 0===o||null===(s=o.object)||void 0===s?void 0:s.name)&&(d=!0),d&&n.push({identifier:c,locStart:l,locEnd:u})}));var a=[],r=t.body.filter((function(e){return"ExpressionStatement"==e.type}));r.forEach((function(e){var t,n,i="Ui"==(null===(t=e.expression.callee)||void 0===t||null===(n=t.object)||void 0===n?void 0:n.name);if(i){var r="";e.expression.arguments.length>1&&(r=e.expression.arguments[1].value);var o=e.loc.start.line,s=e.loc.end.line;a.push({label:r,locStart:o,locEnd:s})}})),this.toneObjectDeclarations=n,this.uiObjectStatements=a}},{key:"annotateVisualsLineOfCode",value:function(){var e=this,t=3,n=this.uiObjectStatements.length;this.visuals.forEach((function(i,a){if(a<t)i.locStart=null,i.locEnd=null;else if(a<t+n){var r=e.uiObjectStatements[a-t];i.locStart=r.locStart,i.locEnd=r.locEnd}else i.locStart=i.declarationObj.locStart,i.locEnd=i.declarationObj.locEnd}))}},{key:"signalObjects",get:function(){var e=this,t=[];return this.annotateVisualsLineOfCode(),this.visuals.length>0&&(t=this.visuals.map((function(t){if(t.type==Be)return t;if(t.type==ze)return t;if(t.type||(t.type=Ve,He.includes(t.signal.name)&&(t.type=Me),$e.includes(t.signal.name)&&(t.type=Ue)),"Param"==t.signal.name)return{renderValue:function(e){return e.value},signal:t.signal,name:t.name||t.signal.name,type:Me,locStart:t.locStart,locEnd:t.locEnd};if(t.type==Me){var n=new e._tone.Meter({normalRange:!0});return t.signal.connect(n),{meter:n,name:t.name||t.signal.name,type:Me,locStart:t.locStart,locEnd:t.locEnd}}if(t.type==Ue){var i=new e._tone.Mono,a=new e._tone.Analyser({type:"fft",size:512,channels:1});return i.connect(a),t.signal.connect(i),{fft:a,name:t.name||t.signal.name,type:Ue,locStart:t.locStart,locEnd:t.locEnd}}if(t.type==Ve){var r=new e._tone.Mono,o=new e._tone.Analyser({type:"waveform",size:512,smoothing:.9,channels:1});return r.connect(o),t.signal.connect(r),{waveform:o,name:t.name||t.signal.name,type:Ve,locStart:t.locStart,locEnd:t.locEnd}}if(t.type==We){var s=new e._tone.Meter({channels:2,smoothing:0});return s.normalRange=!0,t.signal.connect(s),{meter:s,name:t.name||t.signal.name,type:We,locStart:t.locStart,locEnd:t.locEnd}}}))),t=Pe()(t,(function(e){return e.locStart?e.locStart:-1})),t}}]),e}(),Ke=(n("7d3a"),n("2ef0")),Ye=n.n(Ke),Je=n("8a60"),qe=n.n(Je),Xe="14.7.77",Qe={name:"Editor",components:{Header:D,Footer:U,Meter:ne,Waveform:ce,Spectrum:me,Scope:ye,Slider:Ae,Button:Oe,Notification:Y},props:{},data:function(){return{editor:null,output:null,text:"",lastExecutedText:"",windowWidth:100,windowHeight:1e3,headerHeight:54,footerHeight:40,editorLeft:400,hasError:!1,errorName:"name",errorLine:0,errorMessage:"",signalObjects:[],visualSizes:{small:[120,90],medium:[185,138],large:[380,90]},visualSize:"small",cursorLineNumber:0,decorations:null}},computed:{visualsWidth:function(){return this.visualSizes[this.visualSize][0]},visualsHeight:function(){return this.visualSizes[this.visualSize][1]},editorStyle:function(){var e=this.windowHeight-this.headerHeight-this.footerHeight,t=this.windowWidth-this.editorLeft,n={left:"".concat(this.editorLeft,"px"),width:"".concat(t,"px"),height:"".concat(e,"px"),backgroundColor:"black"};return n},visualsStyle:function(){var e=this.windowHeight-this.headerHeight-this.footerHeight;return{left:"0px",width:"".concat(this.editorLeft,"px"),height:"".concat(e,"px"),"grid-template-columns":"repeat(auto-fill, ".concat(this.visualsWidth,"px)"),"grid-auto-rows":"".concat(this.visualsHeight,"px"),backgroundColor:"teal"}},hasUnappliedChanges:function(){return this.text!=this.lastExecutedText}},beforeDestroy:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.closeContext();case 2:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;this.text=this.$store.getters.activeFile.code,this.loadDefinition(),qe.a.bind("command+s",(function(){return e.$store.dispatch("saveCurrentToFile"),!1})),qe.a.bind("command+return",(function(){return e.emitChange(),!1})),qe.a.bind("command+o",(function(){return e.$store.dispatch("openFile"),!1})),qe.a.bind("command+.",(function(){return e.closeContext(),!1}))},methods:{createEditor:function(){var e=this,t=this.$refs.editor,i=j["editor"].createModel(this.text,"typescript");this.editor=j["editor"].create(t,{model:i,theme:"vs-dark",scrollBeyondLastLine:!1,multiCursorModifier:"ctrlCmd",minimap:{enabled:!1},lineNumbers:"on"}),this.$store.commit("setEditorReference",this.editor),j["editor"].defineTheme("transparentBgTheme",{base:"vs-dark",inherit:!0,rules:[{background:"000000"}],colors:{"editor.background":"#000000",peekWidgetDefaultFocus:"tree"}}),j["editor"].setTheme("transparentBgTheme"),j["languages"].registerDocumentFormattingEditProvider("typescript",{provideDocumentFormattingEdits:function(e,t,i){return Object(d["a"])(regeneratorRuntime.mark((function t(){var i,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.e("chunk-2d0b9262").then(n.t.bind(null,"325b",7));case 2:return i=t.sent,t.next=5,n.e("chunk-2d0ceaf4").then(n.t.bind(null,"6103",7));case 5:return a=t.sent,r=i.format(e.getValue(),{parser:"babel",plugins:[a],singleQuote:!1,printWidth:80}),t.abrupt("return",[{range:e.getFullModelRange(),text:r}]);case 8:case"end":return t.stop()}}),t)})))()}}),j["languages"].typescript.typescriptDefaults.setCompilerOptions({target:j["languages"].typescript.ScriptTarget.ES2015,allowNonTsExtensions:!0,lib:["ES2015"]}),j["languages"].typescript.typescriptDefaults.addExtraLib(this.declr,"file:///node_modules/tone/index.d.ts"),j["languages"].typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!0}),j["languages"].typescript.javascriptDefaults.setCompilerOptions({noLib:!1,allowNonTsExtensions:!0,lib:["es2019"]}),this.editor._standaloneKeybindingService.addDynamicKeybinding("-editor.action.quickFix",null,(function(){})),this.editor.onDidChangeModelContent((function(){var t=e.editor.getValue();e.text!==t&&(e.text=t)})),this.editor.onDidChangeCursorPosition((function(){e.cursorLineNumber=e.editor.getPosition().lineNumber}));var a=this;this.editor.addCommand(j["KeyMod"].CtrlCmd|j["KeyCode"].Enter,(function(){a.emitChange()})),this.editor.addCommand(j["KeyMod"].CtrlCmd|j["KeyCode"].KEY_S,(function(){a.$store.dispatch("saveCurrentToFile")})),this.editor.addCommand(j["KeyMod"].CtrlCmd|j["KeyCode"].US_DOT,(function(){a.closeContext()})),this.editor.addCommand(j["KeyMod"].CtrlCmd|j["KeyCode"].KEY_O,(function(){a.$store.dispatch("openFile")})),window.addEventListener("resize",(function(){a.resize()})),a.resize()},emitChange:function(){var e=this,t=T["getContext"](),n=new T["Context"];T["setContext"](n),this.toneContext=n,T["start"]();var i=this;this.editor.getAction("editor.action.formatDocument").run().then((function(){i.startFunction(),i.$store.dispatch("updateCode",e.text),i.hasError=!1,t&&"closed"!=t.state&&t.close()})).catch((function(e){if(i.hasError=!0,i.errorName=e.name,e.stack.includes("<anonymous>:")){var n=parseInt(e.stack.split("<anonymous>:")[1].split(":")[0],10);i.errorLine=n-2}i.errorMessage=e.message,T["setContext"](t),i.toneContext=t}))},closeContext:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.toneContext){t.next=5;break}return t.next=3,e.toneContext.close();case 3:e.toneContext=null,e.$store.commit("setIsNotRunning");case 5:case"end":return t.stop()}}),t)})))()},startFunction:function(){var e=new Ge(T),t=T["getDestination"]();e.meter(t,"Main"),e.spectrum(t,"Main"),e.scope(t,"Main");var n=this.text.replaceAll("Tone.Transport","Tone.getTransport()");n+="\n      Ui.toneObjectDeclarations.forEach((i) => {\n        Ui._autoDisplay(eval(i.identifier), i);\n      });",e.evaluateSource(n),n+="\n        // Run at the end of the function code.\n        const addCompressorToChain = true;\n        // Add an aggressive compressor as a limiter for user safety.\n        // Requires patched Tone.js.\n        const __destination = Tone.getDestination();\n        const __compressor = new Tone.Compressor({\n          attack: 0,\n          knee: 0,\n          ratio: 20,\n          release: 0.5,\n          threshold: 0,\n        });\n        if(__destination.chainItems){\n            const __chainItems = [...__destination.chainItems];\n            __chainItems.forEach(n => n.disconnect());\n            __chainItems.push(__compressor);\n            __destination.chain(...__chainItems);\n        }else{\n          console.warn(\"Tone.js is unpatched. Missing destination.chainItems.\");\n        }\n        if (typeof title !== 'undefined'){\n          Ui._title = title;\n        }\n      ",new Function("Tone","Tonal","_","CodeWarbler","Ui",n)(T,F,Ye.a,e,e),this.signalObjects=e.signalObjects,this.$store.commit("setIsRunning"),this.$store.dispatch("updateTitle",e._title),this.lastExecutedText=this.text},loadDefinition:function(){var e="https://tonejs.github.io/docs/".concat(Xe,"/assets/tone.d.ts"),t=this;fetch(e).then((function(e){return e.text()})).then((function(e){e=e.replace("declare module 'tone' {","namespace Tone {"),e+="\ninterface Console {\n  log(message?: any, ...optionalParams: any[]): void;\n}\ndeclare var Console: {\n  prototype: Console;\n  new(): Console;\n};\nconst console = new Console();\n\n// Declaration for Ui needs to be completed by hand here.\n/**\n* Ui object\n*/\nnamespace Ui {\n      /**\n      * Make the display.\n      */\n      declare function display(signal: any, label?: string): void;\n      /**\n      * Make the scope.\n      */\n      declare function scope(signal: any, label?: string): void;\n      /**\n      * Make the meter.\n      */\n      declare function meter(signal: any, label?: string): void;\n      /**\n      * Make the waveform.\n      */\n      declare function waveform(signal: any, label?: string): void;\n      /**\n      * Make the spectrum.\n      */\n      declare function spectrum(signal: any, label?: string): void;\n      /**\n      * Make the button.\n      */\n      declare function button(onClickedFunction: () => string, label?: string): void;\n      /**\n      * Make the slider.\n      */\n      declare function slider(onChangedFunction: (value) => string, label?: string): void;\n}\n\n\n",t.declr=e,t.createEditor()}))},resize:function(){this.windowWidth=document.documentElement.clientWidth,this.windowHeight=window.innerHeight;var e=this;this.$nextTick((function(){e.editor.layout()}))},isLineActive:function(e){return this.cursorLineNumber>=e.locStart&&this.cursorLineNumber<=e.locEnd&&null!=e.locStart},makeLinesActive:function(e){e.locStart&&(this.decorations=this.editor.deltaDecorations(this.decorations||[],[{range:new j["Range"](e.locStart,1,e.locEnd,1),options:{isWholeLine:!0,linesDecorationsClassName:"lineHighlightDecoration"}}]))},makeLinesInactive:function(){this.decorations&&(this.decorations=this.editor.deltaDecorations(this.decorations,[]))}}},Ze=Qe,et=(n("58d3"),Object(c["a"])(Ze,O,S,!1,null,null,null)),tt=et.exports;i["a"].use(C["a"]);var nt=[{path:"/",component:tt}],it=new C["a"]({mode:"history",base:"/warbler/".concat("0.1","/"),routes:nt}),at=it;i["a"].config.productionTip=!1,new i["a"]({store:E,router:at,render:function(e){return e(u)}}).$mount("#app")},"58d3":function(e,t,n){"use strict";n("f08e")},"68d1":function(e,t,n){"use strict";n("d9c3")},"709a":function(e,t,n){"use strict";n("a3aa")},8521:function(e,t,n){},"85ec":function(e,t,n){},9028:function(e,t,n){"use strict";n("0f4e")},"9eae":function(e,t,n){"use strict";n("c91b")},a3aa:function(e,t,n){},af27:function(e,t,n){"use strict";n("2eef")},b0d0:function(e,t,n){},c91b:function(e,t,n){},d9c3:function(e,t,n){},f08e:function(e,t,n){},f437:function(e,t,n){"use strict";n("b0d0")}});
//# sourceMappingURL=app.cd3efdd5.js.map